{
    "builders": [
        {
            "type": "proxmox",
            "proxmox_url": "https://{{ user `proxmox_host` }}/api2/json",
            "username": "{{ user `proxmox_api_user` }}",
            "password": "{{ user `proxmox_api_password` }}",
            "node": "{{ user `proxmox_node_name` }}",

            "iso_file": "{{ user `iso_file` }}",

            "iso_url": "{{ user `iso_url` }}",
            "iso_storage_pool": "{{ user `iso_storage_pool` }}",
            "iso_checksum": "{{ user `iso_checksum` }}",

            "insecure_skip_tls_verify": "{{ user `proxmox_insecure_tls` }}",

            "pool": "{{ user `proxmox_pool` }}",

            "vm_name": "{{ user `template_name` }}",
            "vm_id": "{{ user `vmid` }}",
            "os": "win10",
            "memory": "{{ user `memory` }}",
            "cores": "{{ user `cores` }}",
            "sockets": "{{ user `sockets` }}",
            "cpu_type": "{{ user `cpu_type` }}",
            "vga": {
                "type": "{{ user `vga_type` }}",
                "memory": "{{ user `vga_memory` }}"
            },

            "network_adapters": [
                {
                    "bridge": "{{ user `network_adapter` }}",
                    "model": "{{ user `network_adapter_model` }}"
                }
            ],

            "disks": [
                {
                    "storage_pool": "{{ user `datastore` }}",
                    "storage_pool_type": "{{ user `datastore_type` }}",
                    "type": "{{ user `disk_type` }}",
                    "disk_size": "{{ user `disk_size` }}",
                    "cache_mode": "{{ user `disk_cache` }}",
                    "format": "{{ user `disk_format` }}"
                }
            ],
            "additional_iso_files": [
                {
                  "device": "sata3",
                  "iso_url": "./Autounattend.iso",
                  "iso_checksum": "{{ user `win_autounattend_iso_checksum` }}",
                  "iso_storage_pool": "{{ user `iso_storage_pool` }}",
                  "unmount": true
                },
                {
                  "device": "sata4",
                  "iso_file": "synology:iso/virtio-win-0.1.185.iso",
                  "unmount": true
                }
            ], 
            "boot": "order={{ user `disk_type` }}0;ide2;net0",

            "template_name": "{{ user `template_name` }}",
            "template_description": "{{ user `template_description` }}",

            "unmount_iso": true,
            "onboot": "{{ user `start_on_boot` }}",
            "qemu_agent": true,
            "disable_kvm": "{{ user `disable_kvm` }}",
            "scsi_controller": "{{ user `scsi_controller` }}",

            "communicator": "winrm",
            "winrm_username": "{{ user `winrm_username` }}",
            "winrm_password": "{{ user `winrm_password` }}",
            "winrm_insecure": true,
            "winrm_use_ssl": false
        }
    ],
    "variables": {
        "proxmox_host": "localhost:8006",
        "proxmox_insecure_tls": "false",
        "proxmox_node_name": "proxmox",
        "proxmox_api_user": "user@pve",
        "proxmox_api_password": "passw0rd",
        "proxmox_pool": "",

        "iso_file": "synology:iso/win-server-2019_x64FRE_en-us.iso",

        "iso_url": "",
        "iso_storage_pool": "images",
        "iso_checksum": "",

        "win_autounattend_iso_checksum": "",

        "template_name": "windows-server-2019-template",
        "template_description": "Windows server 2019, generated by packer on {{ isotime \"2006-01-02 03:04:05\" }}",

        "vmid": "1000",
        "sockets": "1",
        "cores": "2",
        "cpu_type": "host",
        "memory": "2048",
        "vga_type": "std",
        "vga_memory": "32",
        "network_adapter": "vmbr0",
        "network_adapter_model": "virtio",
        "disk_size": "20G",
        "disk_type": "scsi",
        "disk_format": "qcow2",
        "disk_cache": "none",
        "datastore": "storage",
        "datastore_type": "directory",

        "start_on_boot": "false",
        "disable_kvm": "false",
        "scsi_controller": "virtio-scsi-pci",

        "winrm_username": "Administrator",
        "winrm_password": "packer"
    }
}